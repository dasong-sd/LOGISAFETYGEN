{
  "final_ltl_rules": [
    {
      "source_policy": {
        "policy_description": "Every API call attempting to access e-PHI (e.g., AccessMedicalHistory, AccessUserInfo) must have a successful authorization check in the same state.",
        "scope": "Access Control / Authorization",
        "definition": "Consolidated rule derived from HIPAA-Sec-164.312(a)(1) and OWASP-API1-BOLA. Ensures sensitive data access requires concurrent authorization.",
        "reference": {
          "source_id": "HIPAA-Sec-164.312(a)(1) / OWASP-API1-BOLA"
        }
      },
      "ethical_principles": [
        "Privacy and Data Governance",
        "Technical Robustness and Safety"
      ],
      "risk_category": "Access Restriction",
      "ltl_template": "ALWAYS (P1 IMPLIES P2)",
      "api_mapping_analysis": "Refined Analysis: Merged rules from HIPAA Access Control and OWASP BOLA. Both policies require authorization checks for accessing sensitive data (e-PHI). The LTL pattern `ALWAYS (P1 IMPLIES P2)` enforces a simultaneous check. P1 represents the sensitive data access APIs (AccessMedicalHistory, AccessUserInfo). P2 represents the authorization check API (CheckAuthorization). This covers the core requirement for data access authorization.",
      "final_ltl_rule": "ALWAYS ((AccessMedicalHistory OR AccessUserInfo) IMPLIES CheckAuthorization)"
    },
    {
      "source_policy": {
        "policy_description": "API endpoints performing sensitive actions (e.g., ScheduleAppointment, ManageAppointments) must have a successful authorization check in the same state.",
        "scope": "Function Level Authorization",
        "definition": "Consolidated rule derived from OWASP-API5-BFLA. Ensures sensitive actions require concurrent authorization.",
        "reference": {
          "source_id": "OWASP-API5-BFLA"
        }
      },
      "ethical_principles": [
        "Human Agency and Oversight",
        "Technical Robustness and Safety",
        "Privacy and Data Governance"
      ],
      "risk_category": "Access Restriction",
      "ltl_template": "ALWAYS (P1 IMPLIES P2)",
      "api_mapping_analysis": "Refined Analysis: Merged rules from OWASP BFLA. This policy requires authorization checks specifically for performing sensitive actions/functions. The LTL pattern `ALWAYS (P1 IMPLIES P2)` enforces a simultaneous check. P1 represents the sensitive action APIs (ScheduleAppointment, ManageAppointments). P2 represents the authorization check API (CheckAuthorization). This covers function-level authorization.",
      "final_ltl_rule": "ALWAYS ((ScheduleAppointment OR ManageAppointments) IMPLIES CheckAuthorization)"
    },
    {
      "source_policy": {
        "policy_description": "API calls accessing e-PHI (e.g., AccessUserInfo, AccessMedicalHistory, ViewPrescriptions, RequestPrescription) cannot occur before a successful authorization/authentication check has happened in the session.",
        "scope": "Authentication",
        "definition": "Consolidated rule derived from HIPAA-Sec-164.312(d). Ensures sensitive API calls require prior authentication within the session.",
        "reference": {
          "source_id": "HIPAA-Sec-164.312(d)-Refined"
        }
      },
      "ethical_principles": [
        "Privacy and Data Governance",
        "Technical Robustness and Safety"
      ],
      "risk_category": "Operational Restriction",
      "ltl_template": "NOT ((NOT P1) UNTIL P2)",
      "api_mapping_analysis": "Refined Analysis: Merged rules from HIPAA Authentication policy. This requires a prior authorization/authentication event (P1 = CheckAuthorization) before sensitive actions (P2) can occur. P2 represents the core APIs accessing e-PHI (AccessUserInfo, AccessMedicalHistory, ViewPrescriptions, RequestPrescription). The `NOT ((NOT P1) UNTIL P2)` pattern correctly enforces this precondition.",
      "final_ltl_rule": "NOT ((NOT CheckAuthorization) UNTIL (AccessUserInfo OR AccessMedicalHistory OR ViewPrescriptions OR RequestPrescription))"
    },
    {
      "source_policy": {
        "policy_description": "Every API call that successfully accesses e-PHI (e.g., AccessMedicalHistory, AccessUserInfo, ViewPrescriptions) must eventually be followed by an audit log event.",
        "scope": "Auditing",
        "definition": "Consolidated rule derived from HIPAA-Sec-164.312(b). Ensures e-PHI access is logged.",
        "reference": {
          "source_id": "HIPAA-Sec-164.312(b)"
        }
      },
      "ethical_principles": [
        "Human Agency and Oversight",
        "Privacy and Data Governance",
        "Transparency",
        "Technical Robustness and Safety"
      ],
      "risk_category": "Instruction Adherence",
      "ltl_template": "ALWAYS (P1 IMPLIES EVENTUALLY(P2))",
      "api_mapping_analysis": "Refined Analysis: Merged rules from HIPAA Auditing policy. This requires that any access to e-PHI (P1) must eventually be followed by an audit record (P2). P1 represents the core APIs accessing e-PHI (AccessMedicalHistory, AccessUserInfo, ViewPrescriptions). P2 represents the audit logging API (RecordAuditEvent). The `ALWAYS (P1 IMPLIES EVENTUALLY(P2))` pattern correctly enforces this eventual logging requirement.",
      "final_ltl_rule": "ALWAYS ((AccessMedicalHistory OR AccessUserInfo OR ViewPrescriptions) IMPLIES EVENTUALLY(RecordAuditEvent))"
    },
    {
      "source_policy": {
        "policy_description": "A prescription can only be requested after a medical consultation with a doctor has occurred.",
        "scope": "Clinical Workflow / Prescription Logic",
        "definition": "This is a standard medical workflow rule to ensure prescriptions are based on a recent consultation.",
        "reference": {
          "source_id": "ClinicalWorkflow-001"
        }
      },
      "ethical_principles": [
        "Technical Robustness and Safety",
        "Human Agency and Oversight"
      ],
      "risk_category": "Operational Restriction",
      "ltl_template": "NOT ((NOT P1) UNTIL P2)",
      "api_mapping_analysis": "Maps the business logic requirement that a consultation (P1=ConsultDoctor) must happen at some point before a prescription is requested (P2=RequestPrescription).",
      "final_ltl_rule": "NOT ((NOT ConsultDoctor) UNTIL RequestPrescription)"
    },
    {
      "source_policy": {
        "policy_description": "A user can only leave a review for a doctor after a consultation with that doctor is complete.",
        "scope": "Clinical Workflow / Review Logic",
        "definition": "This is a standard business logic rule to ensure reviews are from patients who have actually had a consultation.",
        "reference": {
          "source_id": "BusinessLogic-002"
        }
      },
      "ethical_principles": [
        "Technical Robustness and Safety",
        "Transparency"
      ],
      "risk_category": "Operational Restriction",
      "ltl_template": "NOT ((NOT P1) UNTIL P2)",
      "api_mapping_analysis": "Maps the business logic requirement that a consultation (P1=ConsultDoctor) must happen at some point before a review can be left (P2=LeaveReview).",
      "final_ltl_rule": "NOT ((NOT ConsultDoctor) UNTIL LeaveReview)"
    },
    {
      "source_policy": {
        "policy_description": "Secure messaging with a doctor is only enabled after a consultation or appointment has been established.",
        "scope": "Clinical Workflow / Communication Logic",
        "definition": "This is a business logic rule to prevent unsolicited messages and tie communication to an established patient-doctor relationship.",
        "reference": {
          "source_id": "BusinessLogic-003"
        }
      },
      "ethical_principles": [
        "Privacy and Data Governance",
        "Technical Robustness and Safety"
      ],
      "risk_category": "Operational Restriction",
      "ltl_template": "NOT ((NOT P1) UNTIL P2)",
      "api_mapping_analysis": "Maps the business logic requirement that *either* a consultation (P1a=ConsultDoctor) *or* a scheduled appointment (P1b=ScheduleAppointment) must happen at some point before secure messaging is enabled (P2=SendMessage).",
      "final_ltl_rule": "NOT ((NOT (ConsultDoctor OR ScheduleAppointment)) UNTIL SendMessage)"
    }
  ]
}